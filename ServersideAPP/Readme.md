####  2 - ServersideAPP (Authority who would like to register users) 

**Technical Requirement**
    
    1 - Java 1.8.0.211
    
    2 - Web3J 4.5.0 (Java library/Bin)
    
    3 - IPFS v1.2.2 (Java library) 
    
    4 - IPFS Installed version (0.4.21) (Windows OS Supproetd)

    5 - Truffle version v5.0.8
    
    6 - solidity-windows Version: 0.5.11+commit.22be8592.Windows.msvc (Soldiity windows compiler) 
    
    7 - IDEA IntelliJ (Recommended to open all three projects / otherwise you can use your own editors)
    
**How to Run** 

Step 1: Run the IPFS daemon 

`  > ipfs daemon
`

Step 2: Run Truffle console (For local test) and migrate all contracts.

`  > truffle develop
`
`  > migrate
` 

Step 3: Open IDEA IntelliJ and select ServersideAPP and then press Run on AuthoritySpringApp.

Step 4: Go to the URL : http://localhost:8090/

Step 6: Now you can add the PII Data. 

**Description:**

The server APP is the "Authorty's APP" built in Java Spring technology using Maven depenency manager.   
This project sole purpose is to allow the owner or the administrator to register any users with their Full name, age , 
home address and photo along with the wallet address. 

**Directory Information**

This is a traditional java spring project with the package com.farhan.piiverification. Under this package
two more packages are there. Below are the important folders and files information,

a) blockchain: It has some java interfaces to generalize the common functions of any contract along with the contract folder.
 The contract folder has java generated wrappers that were generated by using solidity-windows solc and web3j batch files. 
 
b) web.home: This folder has all the required web-related folders like config, controller, domains, and services. 
  IdentityService implementation has all the significant logics for adding transactions that are called by the identityController. 
  
c) AuthoritySpringApp: This class is on the root, and it has the primary function from where the spring application is initialized.

**Ropsten Network and Ethereum Name Service**

In the Ropsten network Ethereum Name Service is used to get the live AuthorityContract address from piiauthority.eth. 
Then later application calls the AuthorityRegistry function **getLatestVersion** to get the AuthorityPII live address.
All its code are written by utilizing **web3J** library.
    
** Changes in Smart Contract and Geenrate in Java Wrapper**

If you change anything in the EthereumContract project like changing in any contract, then you can automatically generate the new wrappers for AuthortyPII and AuthorityRegistry. There is a cmd file created for this purpose "contract-wrapper-gen.cmd"

> src/contract-wrapper-gen.cmd      

**Starting new Truffle Console Session**
      
If you want to install new contracts in the fresh ganache or truffle console, then you have to delete the content of the file inside.

> resources/smartcontract.properties 

> resources/smartcontract_registry.properties

These two files store the actively deployed contract addresses, network type, and contract owner information. If you change any other
network and runs it, then it detects and deploys the contract on that network.   


**Network configurations** 

    blockchains.ganache.properties : 

_It contains the private key and account address of the first account with host:port._

    blockchains.truffle.properties : 

_It contains the private key and account address of the first account with host:port_

    blockchains.ropsten.properties : 

_It contains the private key and account address with infura ropsten url._ 

These account information denotes the authority administrator. 

**Running Application with any network**

To run the application with Ethereum Ropsten , Ethereum truffle or Ganache , then 
go to the AuthoritySpringApp class and change the config to to any desired network.

> BlockchainConfig.RunBlockchainType = yournetwork 

Later when you will run the application it will detect the releavent network's property file.
